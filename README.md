### Анализ данных секвенирования
# Домашнее задание №4. Отчёт
Целью данного задания является сравнение RNA-seq данных перепрограммированных и неперепрограммированных (контрольных) мышиных эмбриональных фибробластов (MEFs) и нахождение генов, которые наиболее сильно изменяют свою экспрессию в этом процессе.

## Основное задание
Работа проводилась в блокноте [Google Colab](https://colab.research.google.com/drive/1z9jrDAseB99lP7cg2tGueEo8MSUr7w9l?usp=sharing).

### Проверка качества чтений
Перед непосредственной работой со чтениями, проверим их качество с помощью `MultiQC` -- желательно, чтобы у чтений качество было высокое: \
![](https://github.com/akamaaru/hse24_hw4/blob/main/img/base/per_base_sequence_quality.png) \
Можем увидеть, что по всем 6 последовательностям качество чтений остаётся не ниже значения 33 (за редким исключением в виду разрешения графика, см. следующий график).

Теперь посмотрим на график количества чтений заданных уровней качества: \
![](https://github.com/akamaaru/hse24_hw4/blob/main/img/base/per_sequence_quality_scores.png) \
По графику видно, что у большинства чтений значение больше 27, что тоже говорит о высоком качестве. Но тут также показаны чтения, имеющие более низкое качество, те самые, которые не отобразились на предыдущем графике.

### Картирование чтений
Картирование чтений производилось с помощью программы `HISAT2`. Результат картирования для каждого генома представлен в таблице:
| ID             | Тип        | Общее число чтений | Число уникальныо откартированных чтений | Число не уникально откартированных чтений | Общее число и процент откартированных чтений
|----------|:----------:|:----------------:|:----------------:|:----------------:|:----------------:|
| **SRR3414629** | перепрограммированный | 21106089  | 18573565 (88.00%) | 2291406 (10.86%)  | 20864971 (98.86%) |
| **SRR3414630** | перепрограммированный | 15244711  | 13320505 (87.38%) | 1755932 (11.52%) | 15076437 (98.90%) |
| **SRR3414631** | перепрограммированный | 24244069  | 21159606 (87.28%) | 2804769 (11.57%) | 23964375 (98.85%) |
| **SRR3414635** | контрольный           | 20956475  | 18637053 (88.93%) | 2077378 (9.91%) | 20714431 (98.85%) |
| **SRR3414636** | контрольный           | 20307147  | 18032679 (88.80%) | 2040917 (10.05%) | 20073596 (98.85%) |
| **SRR3414637** | контрольный           | 20385570  | 18043406 (88.51%) | 2105269 (10.33%) | 20148675 (98.84%) |

### Подсчёт чтений
С помощью программы `HTSeq` подсчитываем количество чтений, попавших на каждый ген. Посмотрим, сколько чтений не удалось приписать ни к одному гену:
| ID |  Тип   | __no_feature | __ambiguous |
|----|:--------------:|:-------------:|:---------:|
| **SRR3414629** | перепрограммированный | 1620359 | 728893 |
| **SRR3414630** | перепрограммированный | 1251763 | 484967 |
| **SRR3414631** | перепрограммированный | 1718354 | 827751 |
| **SRR3414635** | контрольный           | 1406679 | 767361 |
| **SRR3414636** | контрольный           | 1347210 | 742802 |
| **SRR3414637** | контрольный           | 1411488 | 717538 |

Можно заметить, что в контрольной группе было меньше чтений, не попавших ни в какой ген. По неопределенным чтениям мало что можно сказать, разве что дисперсия неопределенных чтений у перепрограммированной группы больше.

Объединим результаты в один файл, получится файл `ALL.count`. Он загружен в папку `data`. 

## Бонусное задание
Бонусная часть была выполнена в следующем ноутбуке [Google Colab](https://colab.research.google.com/drive/1t7Vj2FO5OVIzI1ud3Zn_Lmz1lOqV3_E3?usp=sharing). 
С помощью R-пакета `DESeq2` были найдены гены, значимо поменявшие свою экспрессию.

Heatmap, отображающий различия между образцами: \
![](https://github.com/akamaaru/hse24_hw4/blob/main/img/bonus/heatmap.png) \
По карте отчётливо видно, что экземпляры контрольной и перепрограммированной группы схожи между собой в одной группе, но различаются между разными группами, что вполне ожидаемо.

MA-график, показывающий Log2FC для генов: \
![](https://github.com/akamaaru/hse24_hw4/blob/main/img/bonus/MA.png) 

Heatmap, отображающий различия между образцами в экспрессии генов: \
![](https://github.com/akamaaru/hse24_hw4/blob/main/img/bonus/heatmap2.png)

Точечная диаграмма, показывающая, у какого гена увеличилась экспрессия: \
![](https://github.com/akamaaru/hse24_hw4/blob/main/img/bonus/scatter.png) \
На графике видно, что экспрессия гена увеличилась в ~1.5 раза по сравнению с контрольной группой.

